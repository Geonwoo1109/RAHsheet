# RAHsheet
1. 2025 개인 프로젝트. RAH 연습실 신청 자동화 챗봇 제작
2. google sheet API 활용

# 작동 방식
1. 공기계의 부계로 카카오톡 알림을 받는다.
2. 원하는 형태로 메시지를 가공한다.
3. 연습실 시트에서 해당 위치를 찾고 정보를 검색한다.
4. 바로 신청 가능하다면 시트에 반영하고 신청한다. 

# 개발일지
25.09.01 | 프로젝트 시작, 시트랑 연동이 안돼서 하루종일 노가다 \
25.09.02 | 구글 시트와 연동 성공 (read / write) 및 사용자 입력값 정규화 (제미나이 버리고 GPT로 갈아탔음 ㅋ) \
25.09.03 | 시트 색상 정보 기입, 셀 병합 기능 추가 중 \
25.09.04 | 완성 1단계 v1.0.0 | 상하좌우 중앙정렬 성공 | 메신저봇에 오류가 너무 많아서 "0.7.36a"로 다운그레이드 \
25.09.05 | 결국 39a 버전으로 돌아왔습니다. 관리자 채팅방 따로 만들어서 거기다가 개발자용 데이터 보내는거 성공 \
25.09.06 | 지금 새벽인데, 아침에 해 뜨고 늦으면 배틀 다녀와서 내부적으로 1차 적용해볼 예정입니다. 그래도 이번 주 안에는 적용 할듯 \
25.09.08 | 새벽 00:30 -> 드디어 본 카톡방에 적용 후 실사용 해봄! 공지 때렸습니다 ㅎㅎ 제발 무사했으면 좋겠다 \
25.09.09 | 새로운 문제점 발견: 다른 동아리에서 신청한 항목을 라 시트에 빨리 적용해야 신청이 안겹칠 수 있음.(할일이 늘어난건 아니지만 조금 빨리 처리할 필요가 생김) -> 다음 인수인계때는 적용 못할듯,, 현규형이 만든거 적용방안 생각해볼 예정 \


input: 
```
  안녕하세요
  9/8(월) 9-11시 마루
  9/4 (목) 23-24 다목적
  9/4(목) 13-14 방음연습실
  
  9/4(목) 14~17 마루연습실
  9/4(월) 14-17 마루연습실
  
  신청 부탁드립니다!
```

output: 
```
{
    "requester": "김건우",
    "time": "9/6(토) 3:38",
    "yes": {
        "다목적": [
            "9/7(일) 19-21 다목적연습실 -> H32:H33 (신청 가능)"
        ],
        "마루": [],
        "방음": [],
        "매트": []
    },
    "no": {
        "다목적": [
            "9/6(토) 14-16 다목적연습실 -> G27:G28 (김건우 신청,김건우 신청)"
        ],
        "마루": [],
        "방음": [],
        "매트": []
    },
    "미확인": []
}
```

errorCode: 
```
var errorCode = {
    "001": "예외 1: 양식 불일치",
    "002": "예외 2: 시간 형식 불일치",
    "003": "예외 3: 과거or4주뒤 날짜입니다.",
    "004": "예외 4: 날짜와 요일 불일치",
}
```

<img width="4320" height="4320" alt="main 1@4x" src="https://github.com/user-attachments/assets/441241a1-cbba-403c-9a62-2518c8534f97" />
<img width="4320" height="4320" alt="main 2@4x" src="https://github.com/user-attachments/assets/48da9932-1ef7-4111-b93e-caf63d4b1d40" />


